<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://www.google.com https://www.gstatic.com https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self' data:; connect-src 'self' https://script.google.com https://www.google.com; frame-src https://www.google.com;">
  <link rel="icon" href="/favicon-16x16.png" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Exhibition - The Future of Fair Launches</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --metallic-silver: #C0C0C0;
      --silver-light: #E8E8E8;
      --silver-dark: #A0A0A0;
      --neon-blue: #15c6e6c0;
      --neon-orange: #fa7e09cb;
      --deep-black: #1A1A1A;
      --charcoal: #0A0A0A;
      --dark-black: #000000;
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: var(--dark-black);
      color: var(--silver-light);
      overflow-x: hidden;
      padding-bottom: 4rem;
    }

    header {
      text-align: center;
      padding: 5rem 2rem 2rem;
      background: radial-gradient(circle at center, var(--charcoal) 0%, var(--dark-black) 100%);
    }

    header h1 {
      font-size: 2.4rem;
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-orange));
      -webkit-background-clip: text;
      background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    header p {
      margin-top: 1rem;
      color: var(--silver-dark);
      font-size: 1.1rem;
    }

    .features {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(270px, 1fr));
      gap: 2rem;
      padding: 3rem 2rem;
      background: var(--deep-black);
    }

    .feature-card {
      background: rgba(255,255,255,0.03);
      border: 1px solid rgba(255,255,255,0.07);
      border-radius: 12px;
      padding: 1.5rem;
      transition: transform 0.2s ease, border 0.2s ease;
    }

    .feature-card:hover {
      transform: translateY(-5px);
      border-color: var(--neon-blue);
    }

    .feature-icon {
      font-size: 1.8rem;
      margin-bottom: 0.8rem;
    }

    .testnet-notice {
      padding: 3rem 2rem;
      background: rgba(255,255,255,0.05);
      margin: 3rem 1rem;
      border-left: 4px solid var(--neon-blue);
      border-radius: 8px;
    }

    .early-access {
      padding: 4rem 2rem;
      text-align: center;
      background: var(--charcoal);
    }

    .registration-form {
      margin: 0 auto;
      max-width: 480px;
      background: rgba(255,255,255,0.05);
      padding: 2rem;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,0.1);
    }

    .form-group {
      margin-bottom: 1.5rem;
      text-align: left;
    }

    .form-group label {
      display: block;
      margin-bottom: 0.5rem;
      color: var(--silver-light);
      font-weight: 500;
    }

    .form-group input {
      width: 100%;
      padding: 0.8rem;
      border: 1px solid var(--silver-dark);
      border-radius: 8px;
      background: var(--deep-black);
      color: var(--silver-light);
      font-size: 1rem;
    }

    .form-group input:focus {
      outline: none;
      border-color: var(--neon-blue);
    }

    .submit-btn {
      background: linear-gradient(90deg, var(--neon-blue), var(--neon-orange));
      color: #fff;
      padding: 0.8rem 1.5rem;
      font-size: 1rem;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      transition: opacity 0.2s;
      width: 100%;
    }

    .submit-btn:hover { opacity: 0.9; }
    .submit-btn:disabled { opacity: 0.5; cursor: not-allowed; }

    .inline-alert {
      padding: 1rem;
      border-radius: 10px;
      margin-top: 1rem;
      display: none;
      animation: fadeIn 0.4s ease-out;
    }

    .inline-alert.show { display: block; }
    .inline-alert.error {
      background: rgba(250,126,9,0.15);
      border: 1px solid var(--neon-orange);
      color: var(--neon-orange);
    }

    .inline-alert.success {
      background: rgba(21,198,230,0.15);
      border: 1px solid var(--neon-blue);
      color: var(--neon-blue);
    }

    footer {
      text-align: center;
      padding: 2rem;
      border-top: 1px solid rgba(255,255,255,0.1);
      background: var(--deep-black);
    }

    .social-links a {
      color: var(--silver-light);
      margin: 0 0.5rem;
      font-size: 1.5rem;
      text-decoration: none;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>

<body>
  <header>
    <h1>Exhibition Defi</h1>
    <p>Pioneering verifiable Fair Token Launches for the AI Era on Nexus</p>
  </header>

  <section class="features">
    <div class="feature-card"><div class="feature-icon">üîí</div><h3>Liquidity Lock Enforcement</h3><p>Smart contract-enforced liquidity locks (minimum 14 days on testnet).</p></div>
    <div class="feature-card"><div class="feature-icon">‚öñÔ∏è</div><h3>Fair Token Distribution</h3><p>Transparent vesting schedules with cliff periods. No surprises, no games.</p></div>
    <div class="feature-card"><div class="feature-icon">üõ°Ô∏è</div><h3>Soft Cap Protection</h3><p>Projects must reach soft cap or all funds refunded automatically.</p></div>
    <div class="feature-card"><div class="feature-icon">üíé</div><h3>Automatic LP Creation</h3><p>Initial liquidity automatically added and locked securely.</p></div>
    <div class="feature-card"><div class="feature-icon">üéØ</div><h3>Hard Cap Limits</h3><p>Instant finalization when hard cap is reached. No manipulation.</p></div>
    <div class="feature-card"><div class="feature-icon">ü§ñ</div><h3>Built for AI Era</h3><p>Powered by Nexus Verifiable Layer Network for scalable AI computation.</p></div>
  </section>

  <div class="testnet-notice">
    <h3>‚ö†Ô∏è Testnet Phase - Your Voice Matters</h3>
    <p><strong>Current Configuration (Testnet Only):</strong></p>
    <ul style="margin:1rem 0; padding-left:2rem; line-height:2;">
      <li>Minimum liquidity lock: 14 days</li>
      <li>Maximum project duration: 21 days</li>
      <li>Minimum start delay: 15 minutes</li>
    </ul>
    <p><strong>These parameters are FOR TESTING ONLY.</strong> Community feedback during this phase will shape the final product.</p>
  </div>

  <section class="early-access">
    <h2>Get Early Access to Testnet</h2>
    <div class="registration-form">
      <h3 style="color:var(--neon-blue); margin-bottom:2rem;">Register for Early Access</h3>

      <form id="accessForm" autocomplete="off">
        <div class="form-group">
          <label for="twitter">Your X (Twitter) Handle *</label>
          <input type="text" id="twitter" name="twitter" placeholder="@yourusername" required autocomplete="off" maxlength="15" />
        </div>

        <div class="form-group">
          <label for="wallet">Your Wallet Address *</label>
          <input type="text" id="wallet" name="wallet" placeholder="0x..." required pattern="^0x[a-fA-F0-9]{40}$" inputmode="text" autocomplete="off" maxlength="42" />
          <small style="color:var(--silver-dark);">Click to connect wallet (optional)</small>
        </div>

        <div class="form-group">
          <label for="proof">Proof of Repost (Tweet URL) *</label>
          <input type="url" id="proof" name="proof" placeholder="https://x.com/yourusername/status/..." required autocomplete="off" maxlength="200" />
        </div>

        <div class="g-recaptcha" data-sitekey="6LfQ-vArAAAAAN3L3Qug7MHQg_50xGFgvdiTKVzG"></div>

        <button type="submit" class="submit-btn" id="submitBtn"><span>üöÄ Request Early Access</span></button>

        <div id="inlineMessage" class="inline-alert"></div>
      </form>
    </div>
  </section>

  <footer>
    <div class="social-links">
      <a href="https://x.com/ExhibitionDeFi" target="_blank" rel="noopener noreferrer" title="X (Twitter)">ùïè</a>
      <a href="#" rel="noopener noreferrer" title="Discord">üí¨</a>
      <a href="#" rel="noopener noreferrer" title="Telegram">‚úàÔ∏è</a>
      <a href="#" rel="noopener noreferrer" title="GitHub">üíª</a>
    </div>
    <p style="color:var(--silver-dark);">Built on Nexus Verifiable Layer Network | Testnet Phase | Community-Driven Development</p>
    <p style="color:var(--silver-dark); margin-top:1rem; font-size:0.9rem;">¬© 2025 Exhibition Protocol</p>
  </footer>

  <script>
    (function() {
      'use strict';

      const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbz-_LxDYYDdS7E4e5VtGq_aDTDHT3GZt5urocqCIICGZnvLdZKZ2H9aVYfv08n5zSlbrg/exec";
      const WALLET_REGEX = /^0x[a-fA-F0-9]{40}$/;
      const REPOST_REGEX = /^https?:\/\/(x|twitter)\.com\/([A-Za-z0-9_]{1,15})\/status\/([0-9]+)(\?.*)?$/i;
      const TWITTER_HANDLE_REGEX = /^[A-Za-z0-9_]{1,15}$/;
      
      const inlineMsg = document.getElementById("inlineMessage");

      // XSS Protection: Sanitize text content
      function sanitizeText(text) {
        const div = document.createElement('div');
        div.textContent = text;
        return div.innerHTML;
      }

      // Display message with sanitized content
      function showMessage(text, type = "error") {
        // Clear previous content
        inlineMsg.textContent = '';
        inlineMsg.className = `inline-alert show ${type}`;
        
        // Use textContent instead of innerHTML to prevent XSS
        inlineMsg.textContent = text;
        
        setTimeout(() => inlineMsg.classList.remove("show"), 7000);
      }

      // Validate and sanitize inputs
      function validateInputs(twitter, wallet, proof) {
        // Validate Twitter handle
        const cleanTwitter = twitter.replace(/^@/, '').toLowerCase();
        if (!TWITTER_HANDLE_REGEX.test(cleanTwitter)) {
          return { valid: false, error: "Invalid Twitter handle format" };
        }

        // Validate wallet
        if (!WALLET_REGEX.test(wallet)) {
          return { valid: false, error: "Invalid wallet address format" };
        }

        // Validate proof URL
        if (!REPOST_REGEX.test(proof)) {
          return { valid: false, error: "Invalid repost URL format" };
        }

        // Check if URL contains exhibitiondefi
        if (!proof.toLowerCase().includes("exhibitiondefi")) {
          return { valid: false, error: "Not a repost of @ExhibitionDeFi's post" };
        }

        // Ensure URL length is reasonable
        if (proof.length > 200) {
          return { valid: false, error: "URL too long" };
        }

        return { valid: true, twitter: cleanTwitter, wallet, proof };
      }

      // Wallet connection handler
      const walletInput = document.getElementById('wallet');
      if (walletInput) {
        walletInput.addEventListener('click', async function() {
          if (!window.ethereum) return;
          
          try {
            const accounts = await window.ethereum.request({ 
              method: 'eth_requestAccounts' 
            });
            
            if (accounts && accounts[0] && WALLET_REGEX.test(accounts[0])) {
              this.value = accounts[0];
            }
          } catch (err) {
            console.warn("Wallet connection failed:", err.message);
          }
        });
      }

      // Form submission handler
      const form = document.getElementById("accessForm");
      if (form) {
        form.addEventListener("submit", async function(e) {
          e.preventDefault();
          
          const btn = document.getElementById("submitBtn");
          const twitterInput = document.getElementById("twitter");
          const walletInput = document.getElementById("wallet");
          const proofInput = document.getElementById("proof");

          if (!btn || !twitterInput || !walletInput || !proofInput) {
            showMessage("Form error. Please refresh the page.", "error");
            return;
          }

          const twitter = twitterInput.value.trim();
          const wallet = walletInput.value.trim();
          const proof = proofInput.value.trim();

          // Validate inputs
          const validation = validateInputs(twitter, wallet, proof);
          if (!validation.valid) {
            showMessage(validation.error, "error");
            return;
          }

          // Check reCAPTCHA
          const token = typeof grecaptcha !== 'undefined' ? grecaptcha.getResponse() : '';
          if (!token) {
            showMessage("Please complete the reCAPTCHA.", "error");
            return;
          }

          // Disable button during submission
          btn.disabled = true;
          btn.innerHTML = "<span>‚è≥ Submitting...</span>";

          const payload = {
            twitter: validation.twitter,
            wallet: validation.wallet,
            proof: validation.proof,
            token: token
          };

          try {
            const response = await fetch(GOOGLE_SCRIPT_URL, {
              method: "POST",
              headers: { 
                "Content-Type": "text/plain"
              },
              body: JSON.stringify(payload),
            });

            const text = await response.text();

            // Handle different response types
            switch(text) {
              case "success":
                showMessage("‚úÖ Success! You're on the list.", "success");
                form.reset();
                if (typeof grecaptcha !== 'undefined') {
                  grecaptcha.reset();
                }
                break;
              case "duplicate":
                showMessage("‚ö†Ô∏è You have already registered.", "error");
                break;
              case "recaptcha_failed":
                showMessage("‚ùå reCAPTCHA verification failed. Please try again.", "error");
                if (typeof grecaptcha !== 'undefined') {
                  grecaptcha.reset();
                }
                break;
              case "invalid_wallet":
                showMessage("‚ùå Invalid wallet address.", "error");
                break;
              case "invalid_repost":
                showMessage("‚ùå Invalid repost URL.", "error");
                break;
              default:
                showMessage("‚ùå Submission failed. Please try again.", "error");
            }
          } catch (err) {
            console.error("Submission error:", err);
            showMessage("‚ö†Ô∏è Network error. Please try again.", "error");
          } finally {
            btn.disabled = false;
            btn.innerHTML = "<span>üöÄ Request Early Access</span>";
          }
        });
      }
    })();
  </script>

  <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</body>
</html>